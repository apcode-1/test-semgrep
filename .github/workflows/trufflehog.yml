name: TruffleHog Secret Scan

on:
  pull_request:
    branches: [main, master]

concurrency:
  group: trufflehog-${{ github.ref }}
  cancel-in-progress: true

jobs:
  trufflehog:
    uses: apcode-1/test-semgrep/.github/workflows/central-trufflehog.yml@main
    with:
      block_on_secrets: false  # Monitor mode
    secrets:
      SLACK_WEBHOOK_URL: ${{ secrets.TRUFFLEHOG_SLACK_WEBHOOK_URL }}
    permissions:
      contents: read
      pull-requests: write
      issues: write
