rules:
  # Example: Detect hardcoded internal API patterns
  - id: custom-hardcoded-internal-api
    patterns:
      - pattern-regex: (internal\.company\.com|api\.internal\.)
    message: "Hardcoded internal API endpoint detected. Use environment variables."
    severity: WARNING
    languages: [generic]
    metadata:
      category: security
      confidence: HIGH

  # Example: Detect console.log in production code (JS/TS)
  - id: custom-no-console-log
    pattern: console.log(...)
    paths:
      exclude:
        - "**/test/**"
        - "**/*.test.*"
    message: "Remove console.log before production"
    severity: WARNING
    languages: [javascript, typescript]
    metadata:
      category: best-practice

  # Example: Detect eval usage
  - id: custom-no-eval
    pattern: eval($X)
    message: "eval() is dangerous and should be avoided"
    severity: ERROR
    languages: [javascript, typescript, python]
    metadata:
      category: security
      cwe: "CWE-95: Eval Injection"
